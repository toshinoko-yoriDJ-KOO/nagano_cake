<!--ごう作-->

<h3>ショッピングカート</h3>

<div>
  <%= link_to "カートを空にする", cart_items_destroy_all_path, method: :delete, data: { confirm: "本当に空にしますか？" }, class: "btn btn-danger" %>
</div>

<table>
  <tr>
    <th>商品名</th>
    <th>単価(税込)</th>
    <th>数量</th>
    <th>小計</th>
    <th></th>
  </tr>
  <% @cart_items.each do |cart_item| %>
  <tr>
  <!--計算はモデルにまとめれるらしい-->
    <td><%= cart_item.product.name %></td>
    <td><%= (cart_item.product.price * 1.1).floor %></td>
    <td><%= f.select :product_amount, *[1..3] %></td>
    <td><%= (cart_item.product.price * 1.1).floor * params[:product_amount].to_i %></td>
    <td><%= link_to "削除する", cart_item_path(cart_item), class:"btn-sm btn-danger destroy(cart_items.id)", method: :delete, data: {confirm: "本当に削除しますか?"} %></td>
    <% @total_amount +=  (cart_item.product.price * 1.1).floor * params[:product_amount].to_i %>
  </tr>
  <% end %>
</table>